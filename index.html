<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Калькулятор стоимости услуги</title>
<style>
* {
box-sizing: border-box;
margin: 0;
padding: 0;
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
color: #333;
min-height: 100vh;
display: flex;
justify-content: center;
align-items: center;
padding: 20px;
}

.calculator-container {
width: 100%;
max-width: 600px;
background-color: white;
border-radius: 15px;
box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
overflow: hidden;
}

.calculator-header {
background: linear-gradient(to right, #2c3e50, #4a6491);
color: white;
padding: 25px;
text-align: center;
}

.calculator-header h1 {
font-size: 28px;
margin-bottom: 10px;
}

.calculator-header p {
opacity: 0.8;
font-size: 16px;
}

.calculator-body {
padding: 30px;
}

.form-group {
margin-bottom: 25px;
}

label {
display: block;
margin-bottom: 10px;
font-weight: 600;
color: #2c3e50;
font-size: 16px;
}

input[type="number"] {
width: 100%;
padding: 12px 15px;
border: 2px solid #e0e0e0;
border-radius: 8px;
font-size: 16px;
transition: border-color 0.3s;
}

input[type="number"]:focus {
border-color: #3498db;
outline: none;
}

input[type="number"].invalid {
border-color: #e74c3c;
background-color: #fdf2f2;
}

.error-message {
color: #e74c3c;
font-size: 14px;
margin-top: 5px;
display: none;
}

.radio-group {
display: flex;
flex-direction: column;
gap: 12px;
}

.radio-option {
display: flex;
align-items: center;
padding: 12px 15px;
border: 2px solid #e0e0e0;
border-radius: 8px;
transition: all 0.3s;
cursor: pointer;
}

.radio-option:hover {
border-color: #3498db;
background-color: #f8fafc;
}

.radio-option.selected {
border-color: #3498db;
background-color: #e1f0fa;
}

.radio-option input {
margin-right: 10px;
transform: scale(1.2);
}

.radio-option .price-tag {
margin-left: auto;
background-color: #3498db;
color: white;
padding: 4px 10px;
border-radius: 20px;
font-size: 14px;
font-weight: 600;
}

select {
width: 100%;
padding: 12px 15px;
border: 2px solid #e0e0e0;
border-radius: 8px;
font-size: 16px;
background-color: white;
transition: border-color 0.3s;
}

select:focus {
border-color: #3498db;
outline: none;
}

.checkbox-group {
display: flex;
align-items: center;
padding: 12px 15px;
border: 2px solid #e0e0e0;
border-radius: 8px;
transition: all 0.3s;
}

.checkbox-group:hover {
border-color: #3498db;
}

.checkbox-group input {
margin-right: 10px;
transform: scale(1.3);
}

.hidden {
display: none;
}

.price-display {
background: linear-gradient(to right, #2c3e50, #4a6491);
color: white;
padding: 25px;
text-align: center;
border-radius: 10px;
margin-top: 20px;
}

.price-label {
font-size: 18px;
margin-bottom: 10px;
opacity: 0.9;
}

.price-amount {
font-size: 36px;
font-weight: 700;
}

.details {
margin-top: 15px;
font-size: 14px;
opacity: 0.8;
}

.service-description {
margin-top: 5px;
font-size: 14px;
color: #7f8c8d;
}

@media (max-width: 480px) {
.calculator-body {
padding: 20px;
}

.price-amount {
font-size: 28px;
}
}
</style>
</head>
<body>
<div class="calculator-container">
<div class="calculator-header">
<h1>Калькулятор стоимости услуги</h1>
<p>Рассчитайте стоимость услуги в зависимости от ваших потребностей</p>
</div>

<div class="calculator-body">
<div class="form-group">
<label for="quantity">Количество:</label>
<input type="number" id="quantity" min="1" value="1" step="1">
<div class="error-message" id="quantityError">Пожалуйста, введите положительное число</div>
</div>

<div class="form-group">
<label>Тип услуги:</label>
<div class="radio-group" id="serviceType">
<div class="radio-option selected">
<input type="radio" id="type1" name="serviceType" value="basic" checked>
<label for="type1">Базовая услуга</label>
<span class="price-tag">100 руб/шт</span>
</div>
<div class="service-description">Простая услуга без дополнительных опций</div>

<div class="radio-option">
<input type="radio" id="type2" name="serviceType" value="premium">
<label for="type2">Премиум услуга</label>
<span class="price-tag">200 руб/шт</span>
</div>
<div class="service-description">Услуга с дополнительными опциями на выбор</div>

<div class="radio-option">
<input type="radio" id="type3" name="serviceType" value="custom">
<label for="type3">Кастомная услуга</label>
<span class="price-tag">150 руб/шт</span>
</div>
<div class="service-description">Услуга с дополнительным свойством</div>
</div>
</div>

<div class="form-group hidden" id="optionsGroup">
<label for="options">Опции услуги:</label>
<select id="options">
<option value="standard">Стандартная опция (+0 руб)</option>
<option value="advanced">Продвинутая опция (+50 руб)</option>
<option value="professional">Профессиональная опция (+100 руб)</option>
</select>
</div>

<div class="form-group hidden" id="propertyGroup">
<div class="checkbox-group">
<input type="checkbox" id="property">
<label for="property">Дополнительное свойство (+25% к стоимости)</label>
</div>
</div>

<div class="price-display">
<div class="price-label">Итоговая стоимость:</div>
<div class="price-amount" id="totalPrice">100 руб</div>
<div class="details" id="priceDetails">1 шт × 100 руб/шт = 100 руб</div>
</div>
</div>
</div>

<script>
// Конфигурация цен
const basePrices = {
basic: 100,
premium: 200,
custom: 150
};

// Дополнительные стоимости для опций
const optionPrices = {
standard: 0,
advanced: 50,
professional: 100
};

// Получаем элементы DOM
const quantityInput = document.getElementById('quantity');
const quantityError = document.getElementById('quantityError');
const serviceTypeRadios = document.querySelectorAll('input[name="serviceType"]');
const radioOptions = document.querySelectorAll('.radio-option');
const optionsGroup = document.getElementById('optionsGroup');
const optionsSelect = document.getElementById('options');
const propertyGroup = document.getElementById('propertyGroup');
const propertyCheckbox = document.getElementById('property');
const totalPriceElement = document.getElementById('totalPrice');
const priceDetailsElement = document.getElementById('priceDetails');

// Функция для валидации ввода количества
function validateQuantity() {
const value = quantityInput.value;
const numberValue = parseInt(value, 10);

// Проверяем, является ли значение положительным числом
if (value === '' || isNaN(numberValue) || numberValue < 1) {
quantityInput.classList.add('invalid');
quantityError.style.display = 'block';
return false;
} else {
quantityInput.classList.remove('invalid');
quantityError.style.display = 'none';
return true;
}
}

// Функция для обработки ввода в поле количества
function handleQuantityInput(event) {
// Разрешаем только цифры и управляющие клавиши
const allowedKeys = [
'Backspace', 'Delete', 'Tab', 'Escape', 'Enter',
'ArrowLeft', 'ArrowRight', 'Home', 'End'
];

// Если это управляющая клавиша - разрешаем
if (allowedKeys.includes(event.key)) {
return;
}

// Если это не цифра - предотвращаем ввод
if (!/[0-9]/.test(event.key)) {
event.preventDefault();
return;
}

// После ввода проверяем валидность
setTimeout(() => {
validateQuantity();
updatePriceDisplay();
}, 0);
}

// Функция для обработки вставки текста
function handleQuantityPaste(event) {
const pasteData = event.clipboardData.getData('text');

// Проверяем, содержит ли вставляемый текст только цифры
if (!/^\d+$/.test(pasteData)) {
event.preventDefault();
}
}

// Функция для обработки изменения значения
function handleQuantityChange() {
if (!validateQuantity()) {
// Если значение невалидно, устанавливаем минимальное значение
quantityInput.value = 1;
}
updatePriceDisplay();
}

// Функция для обновления видимости дополнительных полей
function updateFormVisibility() {
const selectedType = document.querySelector('input[name="serviceType"]:checked').value;

// Сбрасываем значения при смене типа
optionsSelect.value = 'standard';
propertyCheckbox.checked = false;

// Управляем видимостью полей в зависимости от типа услуги
switch (selectedType) {
case 'basic':
// Базовый тип - без опций и свойств
optionsGroup.classList.add('hidden');
propertyGroup.classList.add('hidden');
break;
case 'premium':
// Премиум тип - только опции
optionsGroup.classList.remove('hidden');
propertyGroup.classList.add('hidden');
break;
case 'custom':
// Кастомный тип - только свойство
optionsGroup.classList.add('hidden');
propertyGroup.classList.remove('hidden');
break;
}
}

// Функция для расчета общей стоимости
function calculateTotalPrice() {
const quantity = parseInt(quantityInput.value, 10) || 1;
const selectedType = document.querySelector('input[name="serviceType"]:checked').value;

let basePrice = basePrices[selectedType];
let totalPrice = basePrice * quantity;
let details = `${quantity} шт × ${basePrice} руб/шт`;

// Добавляем стоимость опции для премиум типа
if (selectedType === 'premium') {
const selectedOption = optionsSelect.value;
const optionPrice = optionPrices[selectedOption];
totalPrice += optionPrice * quantity;

if (optionPrice > 0) {
details += ` + ${optionPrice} руб/шт (опция)`;
}
}

// Добавляем стоимость свойства для кастомного типа
if (selectedType === 'custom' && propertyCheckbox.checked) {
const originalPrice = totalPrice;
totalPrice *= 1.25; // +25%
details += ` + 25% (свойство)`;
}

return {
total: Math.round(totalPrice),
details: details + ` = ${Math.round(totalPrice)} руб`
};
}

// Функция для обновления отображения цены
function updatePriceDisplay() {
const priceData = calculateTotalPrice();
totalPriceElement.textContent = `${priceData.total} руб`;
priceDetailsElement.textContent = priceData.details;
}

// Функция для обновления выбранного стиля радиокнопок
function updateRadioSelection() {
radioOptions.forEach(option => {
option.classList.remove('selected');
});

const selectedOption = document.querySelector('input[name="serviceType"]:checked').closest('.radio-option');
selectedOption.classList.add('selected');
}

// Добавляем обработчики событий для поля количества
quantityInput.addEventListener('keydown', handleQuantityInput);
quantityInput.addEventListener('paste', handleQuantityPaste);
quantityInput.addEventListener('input', handleQuantityChange);
quantityInput.addEventListener('blur', handleQuantityChange);

// Добавляем обработчики событий для других элементов
serviceTypeRadios.forEach(radio => {
radio.addEventListener('change', function() {
updateFormVisibility();
updatePriceDisplay();
updateRadioSelection();
});
});

optionsSelect.addEventListener('change', updatePriceDisplay);
propertyCheckbox.addEventListener('change', updatePriceDisplay);

// Добавляем обработчики для улучшения UX радиокнопок
radioOptions.forEach(option => {
option.addEventListener('click', function() {
const radioInput = this.querySelector('input[type="radio"]');
radioInput.checked = true;
updateFormVisibility();
updatePriceDisplay();
updateRadioSelection();
});
});

// Инициализация при загрузке
validateQuantity();
updateFormVisibility();
updatePriceDisplay();
updateRadioSelection();
</script>
</body>
</html>